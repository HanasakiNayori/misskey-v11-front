(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{1075:function(e,t,i){"use strict";var a=i(795);i.n(a).a},1076:function(e,t,i){(t=i(4)(!1)).push([e.i,".jvwxssxsytqlqvrpiymarjlzlsxskqsr[data-v-32b547d6]{display:block;color:var(--text);text-decoration:none!important}.jvwxssxsytqlqvrpiymarjlzlsxskqsr *[data-v-32b547d6]{user-select:none;pointer-events:none}.jvwxssxsytqlqvrpiymarjlzlsxskqsr>.container[data-v-32b547d6]{max-width:500px;margin:0 auto;padding:16px}.jvwxssxsytqlqvrpiymarjlzlsxskqsr>.container>.name[data-v-32b547d6]{display:block;margin:0;padding:0}.jvwxssxsytqlqvrpiymarjlzlsxskqsr>.container>.name>[data-icon][data-v-32b547d6]{margin-right:6px}.jvwxssxsytqlqvrpiymarjlzlsxskqsr>.container>[data-icon][data-v-32b547d6]{position:absolute;top:0;bottom:0;right:20px;height:100%}",""]),e.exports=t},1077:function(e,t,i){"use strict";var a=i(796);i.n(a).a},1078:function(e,t,i){(t=i(4)(!1)).push([e.i,'.vupkuhvjnjyqaqhsiogfbywvjxynrgsm[data-v-9ca6d77a]{display:block;text-decoration:none!important}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm *[data-v-9ca6d77a]{user-select:none;pointer-events:none}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container[data-v-9ca6d77a]{display:grid;max-width:500px;margin:0 auto;padding:16px;grid-template-columns:64px 1fr;grid-column-gap:10px}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container[data-v-9ca6d77a]:after{content:"";display:block;clear:both}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.thumbnail[data-v-9ca6d77a]{width:64px;height:64px;color:var(--driveFileIcon)}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body[data-v-9ca6d77a]{display:block;word-break:break-all}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>.name[data-v-9ca6d77a]{display:block;margin:0;padding:0;font-size:.9em;font-weight:700;color:var(--text);word-break:break-word}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>.name>.ext[data-v-9ca6d77a]{opacity:.5}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>.tags[data-v-9ca6d77a]{display:block;margin:4px 0 0;padding:0;list-style:none;font-size:.5em}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>.tags>.tag[data-v-9ca6d77a]{display:inline-block;margin:0 5px 0 0;padding:1px 5px;border-radius:2px}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>footer[data-v-9ca6d77a]{display:block;margin:4px 0 0;font-size:.7em;color:var(--text)}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>footer>.separator[data-v-9ca6d77a]{padding:0 4px}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>footer>.type[data-v-9ca6d77a]{opacity:.7}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>footer>.type>.mk-file-type-icon[data-v-9ca6d77a]{margin-right:4px}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>footer>.created-at[data-v-9ca6d77a],.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>footer>.data-size[data-v-9ca6d77a]{opacity:.7}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>footer>.created-at>[data-icon][data-v-9ca6d77a]{margin-right:2px}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>footer>.nsfw[data-v-9ca6d77a]{color:#bf4633}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm[data-is-selected][data-v-9ca6d77a]{background:var(--primary)}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm[data-is-selected][data-v-9ca6d77a],.vupkuhvjnjyqaqhsiogfbywvjxynrgsm[data-is-selected] *[data-v-9ca6d77a]{color:var(--primaryForeground)!important}',""]),e.exports=t},1079:function(e,t,i){"use strict";var a=i(797);i.n(a).a},1080:function(e,t,i){(t=i(4)(!1)).push([e.i,'.pyvicwrksnfyhpfgkjwqknuururpaztw>.preview[data-v-7d4a753c]{padding:8px;background:var(--bg)}.pyvicwrksnfyhpfgkjwqknuururpaztw>.preview>.preview[data-v-7d4a753c]{width:fit-content;width:-moz-fit-content;max-width:100%;margin:0 auto;box-shadow:1px 1px 4px rgba(0,0,0,.2);overflow:hidden;color:var(--driveFileIcon);justify-content:center}.pyvicwrksnfyhpfgkjwqknuururpaztw>.preview>footer[data-v-7d4a753c]{padding:8px 8px 0;text-align:center;font-size:.8em;color:var(--text);opacity:.7}.pyvicwrksnfyhpfgkjwqknuururpaztw>.preview>footer>.separator[data-v-7d4a753c]{display:inline;padding:0 4px}.pyvicwrksnfyhpfgkjwqknuururpaztw>.preview>footer>.size[data-v-7d4a753c]{display:inline}.pyvicwrksnfyhpfgkjwqknuururpaztw>.preview>footer>.size .time[data-v-7d4a753c]{margin:0 2px}.pyvicwrksnfyhpfgkjwqknuururpaztw>.preview>footer>.size .px[data-v-7d4a753c]{margin-left:4px}.pyvicwrksnfyhpfgkjwqknuururpaztw>.preview>footer>.aspect-ratio[data-v-7d4a753c]{display:inline;opacity:.7}.pyvicwrksnfyhpfgkjwqknuururpaztw>.preview>footer>.aspect-ratio[data-v-7d4a753c]:before{content:"("}.pyvicwrksnfyhpfgkjwqknuururpaztw>.preview>footer>.aspect-ratio[data-v-7d4a753c]:after{content:")"}.pyvicwrksnfyhpfgkjwqknuururpaztw>.info[data-v-7d4a753c]{padding:14px;font-size:.8em;border-top:1px solid var(--faceDivider)}.pyvicwrksnfyhpfgkjwqknuururpaztw>.info>div[data-v-7d4a753c]{max-width:500px;margin:0 auto;color:var(--text)}.pyvicwrksnfyhpfgkjwqknuururpaztw>.info>div>.separator[data-v-7d4a753c]{padding:0 4px}.pyvicwrksnfyhpfgkjwqknuururpaztw>.info>div>.created-at>[data-icon][data-v-7d4a753c]{margin-right:2px}.pyvicwrksnfyhpfgkjwqknuururpaztw>.info>div>.nsfw[data-v-7d4a753c]{color:#bf4633}.pyvicwrksnfyhpfgkjwqknuururpaztw>.menu[data-v-7d4a753c]{padding:0 14px 14px;border-top:1px solid var(--faceDivider)}.pyvicwrksnfyhpfgkjwqknuururpaztw>.menu>div[data-v-7d4a753c]{max-width:500px;margin:0 auto}.pyvicwrksnfyhpfgkjwqknuururpaztw>.hash[data-v-7d4a753c]{padding:14px;border-top:1px solid var(--faceDivider)}.pyvicwrksnfyhpfgkjwqknuururpaztw>.hash>div[data-v-7d4a753c]{max-width:500px;margin:0 auto}.pyvicwrksnfyhpfgkjwqknuururpaztw>.hash>div>p[data-v-7d4a753c]{display:block;margin:0;padding:0;color:var(--text);font-size:.9em}.pyvicwrksnfyhpfgkjwqknuururpaztw>.hash>div>p>[data-icon][data-v-7d4a753c]{margin-right:4px}.pyvicwrksnfyhpfgkjwqknuururpaztw>.hash>div>code[data-v-7d4a753c]{display:block;width:100%;margin:6px 0 0;padding:8px;white-space:nowrap;overflow:auto;font-size:.8em;color:#222;border:1px solid #dfdfdf;border-radius:2px;background:#f5f5f5}',""]),e.exports=t},1081:function(e,t,i){"use strict";var a=i(798);i.n(a).a},1082:function(e,t,i){(t=i(4)(!1)).push([e.i,".kmmwchoexgckptowjmjgfsygeltxfeqs[data-v-0ae6be88]{background:var(--face)}.kmmwchoexgckptowjmjgfsygeltxfeqs>nav[data-v-0ae6be88]{display:block;position:sticky;position:-webkit-sticky;top:0;z-index:1;width:100%;padding:10px 12px;overflow:auto;white-space:nowrap;font-size:.9em;color:var(--text);-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);background-color:var(--mobileDriveNavBg);border-bottom:1px solid rgba(0,0,0,.13)}.kmmwchoexgckptowjmjgfsygeltxfeqs>nav>a[data-v-0ae6be88],.kmmwchoexgckptowjmjgfsygeltxfeqs>nav>p[data-v-0ae6be88]{display:inline;margin:0;padding:0;text-decoration:none!important;color:inherit}.kmmwchoexgckptowjmjgfsygeltxfeqs>nav>a[data-v-0ae6be88]:last-child,.kmmwchoexgckptowjmjgfsygeltxfeqs>nav>p[data-v-0ae6be88]:last-child{font-weight:700}.kmmwchoexgckptowjmjgfsygeltxfeqs>nav>a>[data-icon][data-v-0ae6be88],.kmmwchoexgckptowjmjgfsygeltxfeqs>nav>p>[data-icon][data-v-0ae6be88]{margin-right:4px}.kmmwchoexgckptowjmjgfsygeltxfeqs>nav>span[data-v-0ae6be88]{margin:0 8px;opacity:.5}.kmmwchoexgckptowjmjgfsygeltxfeqs>.browser.fetching[data-v-0ae6be88]{opacity:.5}.kmmwchoexgckptowjmjgfsygeltxfeqs>.browser>.info[data-v-0ae6be88]{border-bottom:1px solid var(--faceDivider)}.kmmwchoexgckptowjmjgfsygeltxfeqs>.browser>.info[data-v-0ae6be88]:empty{display:none}.kmmwchoexgckptowjmjgfsygeltxfeqs>.browser>.info>p[data-v-0ae6be88]{display:block;max-width:500px;margin:0 auto;padding:4px 16px;font-size:10px;color:var(--text)}.kmmwchoexgckptowjmjgfsygeltxfeqs>.browser>.files>.file[data-v-0ae6be88],.kmmwchoexgckptowjmjgfsygeltxfeqs>.browser>.folders>.folder[data-v-0ae6be88]{border-bottom:1px solid var(--faceDivider)}.kmmwchoexgckptowjmjgfsygeltxfeqs>.browser>.files>.more[data-v-0ae6be88]{display:block;width:100%;padding:16px;font-size:16px;color:#555}.kmmwchoexgckptowjmjgfsygeltxfeqs>.browser>.empty[data-v-0ae6be88]{padding:16px;text-align:center;color:#999;pointer-events:none}.kmmwchoexgckptowjmjgfsygeltxfeqs>.browser>.empty>p[data-v-0ae6be88]{margin:0}.kmmwchoexgckptowjmjgfsygeltxfeqs>.fetching .spinner[data-v-0ae6be88]{margin:100px auto;width:40px;height:40px;text-align:center;animation:sk-rotate-data-v-0ae6be88 2s linear infinite}.kmmwchoexgckptowjmjgfsygeltxfeqs>.fetching .dot1[data-v-0ae6be88],.kmmwchoexgckptowjmjgfsygeltxfeqs>.fetching .dot2[data-v-0ae6be88]{width:60%;height:60%;display:inline-block;position:absolute;top:0;background:rgba(0,0,0,.2);border-radius:100%;animation:sk-bounce-data-v-0ae6be88 2s ease-in-out infinite}.kmmwchoexgckptowjmjgfsygeltxfeqs>.fetching .dot2[data-v-0ae6be88]{top:auto;bottom:0;animation-delay:-1s}@-moz-keyframes sk-rotate-data-v-0ae6be88{to{transform:rotate(1turn)}}@-webkit-keyframes sk-rotate-data-v-0ae6be88{to{transform:rotate(1turn)}}@-o-keyframes sk-rotate-data-v-0ae6be88{to{transform:rotate(1turn)}}@keyframes sk-rotate-data-v-0ae6be88{to{transform:rotate(1turn)}}@-moz-keyframes sk-bounce-data-v-0ae6be88{0%,to{transform:scale(0)}50%{transform:scale(1)}}@-webkit-keyframes sk-bounce-data-v-0ae6be88{0%,to{transform:scale(0)}50%{transform:scale(1)}}@-o-keyframes sk-bounce-data-v-0ae6be88{0%,to{transform:scale(0)}50%{transform:scale(1)}}@keyframes sk-bounce-data-v-0ae6be88{0%,to{transform:scale(0)}50%{transform:scale(1)}}.kmmwchoexgckptowjmjgfsygeltxfeqs>.file[data-v-0ae6be88]{display:none}",""]),e.exports=t},1097:function(e,t,i){"use strict";i.r(t);var a=i(0),s=i(3),o=a.default.extend({props:["folder"],computed:{browser(){return this.$parent}},methods:{onClick(){this.browser.cd(this.folder)}}}),r=(i(1075),i(1)),l=Object(r.a)(o,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a",{staticClass:"jvwxssxsytqlqvrpiymarjlzlsxskqsr",attrs:{href:"/i/drive/folder/"+e.folder.id},on:{click:function(t){return t.preventDefault(),e.onClick(t)}}},[i("div",{staticClass:"container"},[i("p",{staticClass:"name"},[i("fa",{attrs:{icon:"folder"}}),e._v(e._s(e.folder.name))],1),i("fa",{attrs:{icon:"angle-right"}})],1)])}),[],!1,null,"32b547d6",null).exports,n=i(455),d=a.default.extend({i18n:Object(s.a)("mobile/views/components/drive.file.vue"),props:["file"],components:{XFileThumbnail:n.a},data:()=>({isSelected:!1}),computed:{browser(){return this.$parent}},created(){this.isSelected=this.browser.selectedFiles.some(e=>e.id==this.file.id),this.browser.$on("change-selection",this.onBrowserChangeSelection)},beforeDestroy(){this.browser.$off("change-selection",this.onBrowserChangeSelection)},methods:{onBrowserChangeSelection(e){this.isSelected=e.some(e=>e.id==this.file.id)},onClick(){this.browser.chooseFile(this.file)}}}),f=(i(1077),Object(r.a)(d,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a",{staticClass:"vupkuhvjnjyqaqhsiogfbywvjxynrgsm",attrs:{href:"/i/drive/file/"+e.file.id,"data-is-selected":e.isSelected},on:{click:function(t){return t.preventDefault(),e.onClick(t)}}},[i("div",{staticClass:"container"},[i("x-file-thumbnail",{staticClass:"thumbnail",attrs:{file:e.file,fit:"cover"}}),i("div",{staticClass:"body"},[i("p",{staticClass:"name"},[i("span",[e._v(e._s(-1!=e.file.name.lastIndexOf(".")?e.file.name.substr(0,e.file.name.lastIndexOf(".")):e.file.name))]),-1!=e.file.name.lastIndexOf(".")?i("span",{staticClass:"ext"},[e._v(e._s(e.file.name.substr(e.file.name.lastIndexOf("."))))]):e._e()]),i("footer",[i("span",{staticClass:"type"},[i("mk-file-type-icon",{attrs:{type:e.file.type}}),e._v(e._s(e.file.type))],1),i("span",{staticClass:"separator"}),i("span",{staticClass:"data-size"},[e._v(e._s(e._f("bytes")(e.file.size)))]),i("span",{staticClass:"separator"}),i("span",{staticClass:"created-at"},[i("fa",{attrs:{icon:["far","clock"]}}),i("mk-time",{attrs:{time:e.file.createdAt}})],1),e.file.isSensitive?[i("span",{staticClass:"separator"}),i("span",{staticClass:"nsfw"},[i("fa",{attrs:{icon:["far","eye-slash"]}}),e._v(" "+e._s(e.$t("nsfw")))],1)]:e._e()],2)])],1)])}),[],!1,null,"9ca6d77a",null).exports);function c(e,t){return 0===t?e:c(t,e%t)}var p=a.default.extend({i18n:Object(s.a)("mobile/views/components/drive.file-detail.vue"),props:["file"],components:{XFileThumbnail:n.a},data:()=>({gcd:c,exif:null}),computed:{browser(){return this.$parent},kind(){return this.file.type.split("/")[0]},style(){return this.file.properties.avgColor?{"background-color":this.file.properties.avgColor}:{}},dlUrl(){return this.file.url}},methods:{rename(){const e=window.prompt(this.$t("rename"),this.file.name);null!=e&&""!=e&&e!=this.file.name&&this.$root.api("drive/files/update",{fileId:this.file.id,name:e}).then(()=>{this.browser.cf(this.file,!0)})},move(){this.$chooseDriveFolder().then(e=>{this.$root.api("drive/files/update",{fileId:this.file.id,folderId:null==e?null:e.id}).then(()=>{this.browser.cf(this.file,!0)})})},del(){this.$root.api("drive/files/delete",{fileId:this.file.id}).then(()=>{this.browser.cd(this.file.folderId)})},toggleSensitive(){this.$root.api("drive/files/update",{fileId:this.file.id,isSensitive:!this.file.isSensitive}),this.file.isSensitive=!this.file.isSensitive},showCreatedAt(){this.$root.dialog({type:"info",text:new Date(this.file.createdAt).toLocaleString()})}}}),h=(i(1079),Object(r.a)(p,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"pyvicwrksnfyhpfgkjwqknuururpaztw"},[i("div",{staticClass:"preview"},[i("x-file-thumbnail",{staticClass:"preview",attrs:{file:e.file,detail:!0}}),"image"!=e.kind?[i("fa",{attrs:{icon:"file"}})]:e._e(),"image"==e.kind&&e.file.properties&&e.file.properties.width&&e.file.properties.height?i("footer",[i("span",{staticClass:"size"},[i("span",{staticClass:"width"},[e._v(e._s(e.file.properties.width))]),i("span",{staticClass:"time"},[e._v("×")]),i("span",{staticClass:"height"},[e._v(e._s(e.file.properties.height))]),i("span",{staticClass:"px"},[e._v("px")])]),i("span",{staticClass:"separator"}),i("span",{staticClass:"aspect-ratio"},[i("span",{staticClass:"width"},[e._v(e._s(e.file.properties.width/e.gcd(e.file.properties.width,e.file.properties.height)))]),i("span",{staticClass:"colon"},[e._v(":")]),i("span",{staticClass:"height"},[e._v(e._s(e.file.properties.height/e.gcd(e.file.properties.width,e.file.properties.height)))])])]):e._e()],2),i("div",{staticClass:"info"},[i("div",[i("span",{staticClass:"type"},[i("mk-file-type-icon",{attrs:{type:e.file.type}}),e._v(" "+e._s(e.file.type))],1),i("span",{staticClass:"separator"}),i("span",{staticClass:"data-size"},[e._v(e._s(e._f("bytes")(e.file.size)))]),i("span",{staticClass:"separator"}),i("span",{staticClass:"created-at",on:{click:e.showCreatedAt}},[i("fa",{attrs:{icon:["far","clock"]}}),i("mk-time",{attrs:{time:e.file.createdAt}})],1),e.file.isSensitive?[i("span",{staticClass:"separator"}),i("span",{staticClass:"nsfw"},[i("fa",{attrs:{icon:["far","eye-slash"]}}),e._v(" "+e._s(e.$t("nsfw")))],1)]:e._e()],2)]),i("div",{staticClass:"menu"},[i("div",[i("ui-input",{attrs:{readonly:"",value:e.file.url}},[e._v("URL")]),i("ui-button",{attrs:{link:"",href:e.dlUrl,download:e.file.name}},[i("fa",{attrs:{icon:"download"}}),e._v(" "+e._s(e.$t("download")))],1),i("ui-button",{on:{click:e.rename}},[i("fa",{attrs:{icon:"pencil-alt"}}),e._v(" "+e._s(e.$t("rename")))],1),i("ui-button",{on:{click:e.move}},[i("fa",{attrs:{icon:["far","folder-open"]}}),e._v(" "+e._s(e.$t("move")))],1),e.file.isSensitive?i("ui-button",{on:{click:e.toggleSensitive}},[i("fa",{attrs:{icon:["far","eye"]}}),e._v(" "+e._s(e.$t("unmark-as-sensitive")))],1):i("ui-button",{on:{click:e.toggleSensitive}},[i("fa",{attrs:{icon:["far","eye-slash"]}}),e._v(" "+e._s(e.$t("mark-as-sensitive")))],1),i("ui-button",{on:{click:e.del}},[i("fa",{attrs:{icon:["far","trash-alt"]}}),e._v(" "+e._s(e.$t("delete")))],1)],1)]),i("div",{staticClass:"hash"},[i("div",[i("p",[i("fa",{attrs:{icon:"hashtag"}}),e._v(e._s(e.$t("hash"))+"\n\t\t\t")],1),i("code",[e._v(e._s(e.file.md5))])])])])}),[],!1,null,"7d4a753c",null).exports),v=a.default.extend({i18n:Object(s.a)("mobile/views/components/drive.vue"),components:{XFolder:l,XFile:f,XFileDetail:h},props:["initFolder","initFile","selectFile","multiple","isNaked","top"],data:()=>({folder:null,file:null,files:[],folders:[],moreFiles:!1,moreFolders:!1,hierarchyFolders:[],selectedFiles:[],info:null,connection:null,fetching:!0,fetchingMoreFiles:!1,fetchingMoreFolders:!1}),computed:{isFileSelectMode(){return this.selectFile}},watch:{top(){this.isNaked&&(this.$refs.nav.style.top=`${this.top}px`)}},mounted(){this.connection=this.$root.stream.useSharedConnection("drive"),this.connection.on("fileCreated",this.onStreamDriveFileCreated),this.connection.on("fileUpdated",this.onStreamDriveFileUpdated),this.connection.on("fileDeleted",this.onStreamDriveFileDeleted),this.connection.on("folderCreated",this.onStreamDriveFolderCreated),this.connection.on("folderUpdated",this.onStreamDriveFolderUpdated),this.initFolder?this.cd(this.initFolder,!0):this.initFile?this.cf(this.initFile,!0):this.fetch(),this.isNaked&&(this.$refs.nav.style.top=`${this.top}px`)},beforeDestroy(){this.connection.dispose()},methods:{onStreamDriveFileCreated(e){this.addFile(e,!0)},onStreamDriveFileUpdated(e){(this.folder?this.folder.id:null)!=e.folderId?this.removeFile(e):this.addFile(e,!0)},onStreamDriveFileDeleted(e){this.removeFile(e)},onStreamDriveFolderCreated(e){this.addFolder(e,!0)},onStreamDriveFolderUpdated(e){(this.folder?this.folder.id:null)!=e.parentId?this.removeFolder(e):this.addFolder(e,!0)},dive(e){this.hierarchyFolders.unshift(e),e.parent&&this.dive(e.parent)},cd(e,t=!1){null!=e?("object"==typeof e&&(e=e.id),this.file=null,this.fetching=!0,this.$root.api("drive/folders/show",{folderId:e}).then(e=>{this.folder=e,this.hierarchyFolders=[],e.parent&&this.dive(e.parent),this.$emit("open-folder",this.folder,t),this.fetch()})):this.goRoot(t)},addFolder(e,t=!1){(this.folder?this.folder.id:null)==e.parentId&&(this.folders.some(t=>t.id==e.id)||(t?this.folders.unshift(e):this.folders.push(e)))},addFile(e,t=!1){if((this.folder?this.folder.id:null)==e.folderId)if(this.files.some(t=>t.id==e.id)){const t=this.files.map(e=>e.id).indexOf(e.id);a.default.set(this.files,t,e)}else t?this.files.unshift(e):this.files.push(e)},removeFolder(e){"object"==typeof e&&(e=e.id),this.folders=this.folders.filter(t=>t.id!=e)},removeFile(e){"object"==typeof e&&(e=e.id),this.files=this.files.filter(t=>t.id!=e)},appendFile(e){this.addFile(e)},appendFolder(e){this.addFolder(e)},prependFile(e){this.addFile(e,!0)},prependFolder(e){this.addFolder(e,!0)},goRoot(e=!1){null==this.folder&&null==this.file||(this.file=null,this.folder=null,this.hierarchyFolders=[],this.$emit("move-root",e),this.fetch())},fetch(){this.folders=[],this.files=[],this.moreFolders=!1,this.moreFiles=!1,this.fetching=!0,this.$emit("begin-fetch");let e=null,t=null;this.$root.api("drive/folders",{folderId:this.folder?this.folder.id:null,limit:21}).then(t=>{21==t.length&&(this.moreFolders=!0,t.pop()),e=t,a()}),this.$root.api("drive/files",{folderId:this.folder?this.folder.id:null,limit:21}).then(e=>{21==e.length&&(this.moreFiles=!0,e.pop()),t=e,a()});let i=!1;const a=()=>{if(i){for(const t of e)this.appendFolder(t);for(const e of t)this.appendFile(e);this.fetching=!1,this.$emit("fetched")}else i=!0,this.$emit("fetch-mid")};null==this.folder&&this.$root.api("drive").then(e=>{this.info=e})},fetchMoreFiles(){this.fetching=!0,this.fetchingMoreFiles=!0;this.$root.api("drive/files",{folderId:this.folder?this.folder.id:null,limit:31,untilId:this.files[this.files.length-1].id}).then(e=>{31==e.length?(this.moreFiles=!0,e.pop()):this.moreFiles=!1;for(const t of e)this.appendFile(t);this.fetching=!1,this.fetchingMoreFiles=!1})},chooseFile(e){this.isFileSelectMode?this.multiple?(this.selectedFiles.some(t=>t.id==e.id)?this.selectedFiles=this.selectedFiles.filter(t=>t.id!=e.id):this.selectedFiles.push(e),this.$emit("change-selection",this.selectedFiles)):this.$emit("selected",e):this.cf(e)},cf(e,t=!1){"object"==typeof e&&(e=e.id),this.fetching=!0,this.$root.api("drive/files/show",{fileId:e}).then(e=>{this.file=e,this.folder=null,this.hierarchyFolders=[],e.folder&&this.dive(e.folder),this.fetching=!1,this.$emit("open-file",this.file,t)})},selectLocalFile(){this.$refs.file.click()},createFolder(){this.$root.dialog({title:this.$t("folder-name"),input:{default:this.folder.name}}).then(({result:e})=>{e?this.$root.api("drive/folders/create",{name:e,parentId:this.folder?this.folder.id:void 0}).then(e=>{this.addFolder(e,!0)}):this.$root.dialog({type:"error",text:this.$t("folder-name-cannot-empty")})})},renameFolder(){null!=this.folder?this.$root.dialog({title:this.$t("folder-name"),input:{default:this.folder.name}}).then(({result:e})=>{e?this.$root.api("drive/folders/update",{name:e,folderId:this.folder.id}).then(e=>{this.cd(e)}):this.$root.dialog({type:"error",text:this.$t("cannot-empty")})}):this.$root.dialog({type:"error",text:this.$t("here-is-root")})},moveFolder(){null!=this.folder?this.$chooseDriveFolder().then(e=>{this.$root.api("drive/folders/update",{parentId:e?e.id:null,folderId:this.folder.id}).then(e=>{this.cd(e)})}):this.$root.dialog({type:"error",text:this.$t("here-is-root")})},urlUpload(){const e=window.prompt(this.$t("url-prompt"));null!=e&&""!=e&&(this.$root.api("drive/files/upload_from_url",{url:e,folderId:this.folder?this.folder.id:void 0}),this.$root.dialog({type:"info",text:this.$t("uploading")}))},onChangeLocalFile(){for(const e of Array.from(this.$refs.file.files))this.$refs.uploader.upload(e,this.folder)},deleteFolder(){null!=this.folder?this.$root.api("drive/folders/delete",{folderId:this.folder.id}).then(e=>{this.cd(this.folder.parentId)}):this.$root.dialog({type:"error",text:this.$t("here-is-root")})}}}),u=(i(1081),Object(r.a)(v,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"kmmwchoexgckptowjmjgfsygeltxfeqs"},[i("nav",{ref:"nav"},[i("a",{attrs:{href:"/i/drive"},on:{click:function(t){return t.preventDefault(),e.goRoot()}}},[i("fa",{attrs:{icon:"cloud"}}),e._v(e._s(e.$t("@.drive")))],1),e._l(e.hierarchyFolders,(function(t){return[i("span",{key:t.id+">"},[i("fa",{attrs:{icon:"angle-right"}})],1),i("a",{key:t.id,attrs:{href:"/i/drive/folder/"+t.id},on:{click:function(i){return i.preventDefault(),e.cd(t)}}},[e._v(e._s(t.name))])]})),null!=e.folder?[i("span",[i("fa",{attrs:{icon:"angle-right"}})],1),i("p",[e._v(e._s(e.folder.name))])]:e._e(),null!=e.file?[i("span",[i("fa",{attrs:{icon:"angle-right"}})],1),i("p",[e._v(e._s(e.file.name))])]:e._e()],2),i("mk-uploader",{ref:"uploader"}),null==e.file?i("div",{staticClass:"browser",class:{fetching:e.fetching}},[e.info?i("div",{staticClass:"info"},[null==e.folder?i("p",[e._v(e._s((e.info.usage/e.info.capacity*100).toFixed(1))+"% "+e._s(e.$t("used")))]):e._e(),null!=e.folder&&(e.folder.foldersCount>0||e.folder.filesCount>0)?i("p",[e.folder.foldersCount>0?[e._v(e._s(e.folder.foldersCount)+" "+e._s(e.$t("folder-count")))]:e._e(),e.folder.foldersCount>0&&e.folder.filesCount>0?[e._v(e._s(e.$t("count-separator")))]:e._e(),e.folder.filesCount>0?[e._v(e._s(e.folder.filesCount)+" "+e._s(e.$t("file-count")))]:e._e()],2):e._e()]):e._e(),e.folders.length>0||e.moreFolders?i("div",{staticClass:"folders"},[e._l(e.folders,(function(e){return i("x-folder",{key:e.id,staticClass:"folder",attrs:{folder:e}})})),e.moreFolders?i("p",[e._v(e._s(e.$t("@.load-more")))]):e._e()],2):e._e(),e.files.length>0||e.moreFiles?i("div",{staticClass:"files"},[e._l(e.files,(function(e){return i("x-file",{key:e.id,staticClass:"file",attrs:{file:e}})})),e.moreFiles?i("button",{staticClass:"more",on:{click:e.fetchMoreFiles}},[e._v("\n\t\t\t\t"+e._s(e.fetchingMoreFiles?this.$t("@.loading"):this.$t("@.load-more"))+"\n\t\t\t")]):e._e()],2):e._e(),0!=e.files.length||e.moreFiles||0!=e.folders.length||e.moreFolders||e.fetching?e._e():i("div",{staticClass:"empty"},[null==e.folder?i("p",[e._v(e._s(e.$t("nothing-in-drive")))]):e._e(),null!=e.folder?i("p",[e._v(e._s(e.$t("folder-is-empty")))]):e._e()])]):e._e(),e.fetching&&null==e.file&&0==e.files.length&&0==e.folders.length?i("div",{staticClass:"fetching"},[e._m(0)]):e._e(),i("input",{ref:"file",staticClass:"file",attrs:{type:"file",multiple:"multiple"},on:{change:e.onChangeLocalFile}}),null!=e.file?i("x-file-detail",{attrs:{file:e.file}}):e._e()],1)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"spinner"},[t("div",{staticClass:"dot1"}),t("div",{staticClass:"dot2"})])}],!1,null,"0ae6be88",null));t.default=u.exports},325:function(e,t,i){var a=i(467);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i(5).default)("194b0d7c",a,!0,{})},455:function(e,t,i){"use strict";var a=i(0),s=i(11),o=i(2),r=a.default.extend({props:{file:{type:Object,required:!0},fit:{type:String,required:!1,default:"cover"},detail:{type:Boolean,required:!1,default:!1}},data:()=>({isContextmenuShowing:!1,isDragging:!1,faFile:o.kb,faFileAlt:o.lb,faFileImage:o.ob,faMusic:o.hc,faFileVideo:o.rb,faFileCsv:o.nb,faFilePdf:o.qb,faFileArchive:o.mb,faFilm:o.sb}),computed:{is(){return this.file.type.startsWith("image/")?"image":this.file.type.startsWith("video/")?"video":"audio/midi"===this.file.type?"midi":this.file.type.startsWith("audio/")?"audio":this.file.type.endsWith("/csv")?"csv":this.file.type.endsWith("/pdf")?"pdf":this.file.type.startsWith("text/")?"textfile":["application/zip","application/x-cpio","application/x-bzip","application/x-bzip2","application/java-archive","application/x-rar-compressed","application/x-tar","application/gzip","application/x-7z-compressed"].some(e=>e===this.file.type)?"archive":"unknown"},isThumbnailAvailable(){return!!this.file.thumbnailUrl&&("image"===this.is||"video"===this.is)},background(){return this.file.properties.avgColor||"transparent"}},mounted(){const e=this.$refs.volumectrl;e&&(e.volume=this.$store.state.device.mediaVolume)},methods:{onThumbnailLoaded(){this.file.properties.avgColor&&Object(s.a)({targets:this.$refs.thumbnail,backgroundColor:"transparent",duration:100,easing:"linear"})},volumechange(){const e=this.$refs.volumectrl;this.$store.commit("device/set",{key:"mediaVolume",value:e.volume})}}}),l=(i(466),i(1)),n=Object(l.a)(r,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"thumbnail",staticClass:"zdjebgpv",class:{detail:e.detail},style:"background-color: "+e.background},[e.detail&&"image"===e.is?i("img",{attrs:{src:e.file.url,alt:e.file.name,title:e.file.name},on:{load:e.onThumbnailLoaded}}):e.detail&&"video"===e.is?i("video",{ref:"volumectrl",attrs:{src:e.file.url,preload:"metadata",controls:""}}):e.isThumbnailAvailable?i("img",{style:"object-fit: "+e.fit,attrs:{src:e.file.thumbnailUrl,alt:""},on:{load:e.onThumbnailLoaded}}):"image"===e.is?i("fa",{staticClass:"icon",attrs:{icon:e.faFileImage}}):"video"===e.is?i("fa",{staticClass:"icon",attrs:{icon:e.faFileVideo}}):e.detail&&"audio"===e.is?i("audio",{ref:"volumectrl",attrs:{src:e.file.url,preload:"metadata",controls:""}}):"audio"===e.is||"midi"===e.is?i("fa",{staticClass:"icon",attrs:{icon:e.faMusic}}):"csv"===e.is?i("fa",{staticClass:"icon",attrs:{icon:e.faFileCsv}}):"pdf"===e.is?i("fa",{staticClass:"icon",attrs:{icon:e.faFilePdf}}):"textfile"===e.is?i("fa",{staticClass:"icon",attrs:{icon:e.faFileAlt}}):"archive"===e.is?i("fa",{staticClass:"icon",attrs:{icon:e.faFileArchive}}):i("fa",{staticClass:"icon",attrs:{icon:e.faFile}}),!e.detail&&e.isThumbnailAvailable&&"video"===e.is?i("fa",{staticClass:"icon-sub",attrs:{icon:e.faFilm}}):e._e()],1)}),[],!1,null,"cd0797c6",null);t.a=n.exports},466:function(e,t,i){"use strict";var a=i(325);i.n(a).a},467:function(e,t,i){(t=i(4)(!1)).push([e.i,".zdjebgpv[data-v-cd0797c6]{display:flex}.zdjebgpv>.icon[data-v-cd0797c6],.zdjebgpv>img[data-v-cd0797c6]{pointer-events:none}.zdjebgpv>.icon-sub[data-v-cd0797c6]{position:absolute;width:30%;height:auto;margin:0;right:4%;bottom:4%}.zdjebgpv>*[data-v-cd0797c6]{margin:auto}.zdjebgpv:not(.detail)>img[data-v-cd0797c6]{height:100%;width:100%;object-fit:cover}.zdjebgpv:not(.detail)>.icon[data-v-cd0797c6]{height:65%;width:65%}.zdjebgpv:not(.detail)>audio[data-v-cd0797c6],.zdjebgpv:not(.detail)>video[data-v-cd0797c6]{width:100%}.zdjebgpv.detail>.icon[data-v-cd0797c6]{height:100px;width:100px;margin:16px}.zdjebgpv.detail[data-v-cd0797c6]>:not(.icon){max-height:300px;max-width:100%;height:100%;object-fit:contain}",""]),e.exports=t},795:function(e,t,i){var a=i(1076);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i(5).default)("2285cd8d",a,!0,{})},796:function(e,t,i){var a=i(1078);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i(5).default)("7f56e418",a,!0,{})},797:function(e,t,i){var a=i(1080);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i(5).default)("5c59118c",a,!0,{})},798:function(e,t,i){var a=i(1082);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i(5).default)("0c5a1489",a,!0,{})}}]);
//# sourceMappingURL=6.11.37.1.js.map