"use strict";!async function(){if("true"==localStorage.getItem("shouldFlush"))return void h();const e=["cs-CZ","da-DK","de-DE","en-US","es-ES","fr-FR","ja-JP","ja-KS","ko-KR","nl-NL","pl-PL","zh-CN","zh-TW"],t=localStorage.getItem("theme");if(t)for(const[e,a]of Object.entries(JSON.parse(t)))document.documentElement.style.setProperty(`--${e}`,a.toString());let a=null;const o=localStorage.getItem("vuex");o&&(a=JSON.parse(o));const n=new URL(location.href);let l=null;`${n.pathname}/`.startsWith("/docs/")&&(l="docs"),`${n.pathname}/`.startsWith("/dev/")&&(l="dev"),`${n.pathname}/`.startsWith("/auth/")&&(l="auth"),`${n.pathname}/`.startsWith("/admin/")&&(l="admin");const s=localStorage.getItem("v")||"11.37.1";let c=null;e.includes(navigator.language)?c=navigator.language:(c=e.find(e=>e.split("-")[0]==navigator.language),null==c&&(c="en-US")),a&&a.device.lang&&e.includes(a.device.lang)&&(c=a.device.lang),localStorage.setItem("lang",c);const r=localStorage.getItem("locale"),i=localStorage.getItem("localeKey");let m=null;if(null==r||i!=`${s}.${c}`){const e=await fetch(`/assets/locales/${c}.json?ver=${s}`).then(e=>e.json());m=e,localStorage.setItem("locale",JSON.stringify(e)),localStorage.setItem("localeKey",`${s}.${c}`)}else m=JSON.parse(r);const g=navigator.userAgent.toLowerCase();let d=/mobile|iphone|ipad|android/.test(g)||window.innerWidth<576;a&&a.device.appTypeForce&&("mobile"===a.device.appTypeForce?d=!0:"desktop"===a.device.appTypeForce&&(d=!1));const u=document.getElementsByTagName("head")[0];if(d){const e=document.getElementsByName("viewport").item(0);e.content=`${e.content},minimum-scale=1,maximum-scale=1,user-scalable=no`,u.appendChild(e)}null==l&&(l=d?"mobile":"desktop");const p=document.createElement("script");function h(){localStorage.setItem("shouldFlush","false"),localStorage.removeItem("locale");try{navigator.serviceWorker.controller.postMessage("clear"),navigator.serviceWorker.getRegistrations().then(e=>{for(const t of e)t.unregister()})}catch(e){console.error(e)}location.reload(!0)}p.src=`/assets/${l}.${s}.js`,p.async=!0,p.defer=!0,u.appendChild(p),window.mkBootTimer=window.setTimeout(async()=>{const e=await fetch("/api/meta",{method:"POST",cache:"no-cache"}),t=await e.json();t.version!=s&&(localStorage.setItem("v",t.version),alert(m.common._settings["update-available"]+"\n"+m.common._settings["update-available-desc"]),h())},3e3)}();