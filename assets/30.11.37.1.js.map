{"version":3,"sources":["webpack:///./src/client/app/common/views/pages/room/room.vue?6b22","webpack:///./src/client/app/common/scripts/room/room.ts","webpack:///./src/client/app/common/views/pages/room/preview.vue?d1ed","webpack:///./src/client/app/common/views/pages/room/preview.vue?c2fd","webpack:///./src/client/app/common/views/pages/room/preview.vue","webpack:///./src/client/app/common/views/pages/room/preview.vue?2b61","webpack:///./src/client/app/common/views/pages/room/room.vue?f897","webpack:///./src/client/app/common/views/pages/room/room.vue?c989","webpack:///./src/client/app/common/views/pages/room/room.vue","webpack:///./src/client/app/common/views/pages/room/room.vue?d5a3","webpack:///./src/client/app/common/scripts/room/furnitures.json5","webpack:///./src/client/app/common/views/pages/room/room.vue?6564","webpack:///./src/client/app/common/views/pages/room/room.vue?1bbb"],"names":["__decorate","decorators","target","key","desc","d","c","arguments","length","r","Object","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","furnitureDefs","crossOrigin","user","isMyRoom","roomInfo","container","options","this","mixers","objects","selectedObject","isTransformMode","graphicsQuality","onChangeSelect","clock","scene","width","window","innerWidth","height","innerHeight","renderer","antialias","stencil","alpha","powerPreference","setPixelRatio","devicePixelRatio","setSize","autoClear","setClearColor","shadowMap","enabled","enableShadow","type","appendChild","canvas","camera","useOrthographicCamera","position","x","y","z","zoom","updateProjectionMatrix","add","ambientLight","roomLight","set","castShadow","shadow","bias","mapSize","shadowQuality","near","far","fov","outLight1","outLight2","controls","OrbitControls","enableZoom","enablePan","minPolarAngle","maxPolarAngle","Math","PI","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","mouseButtons","LEFT","MIDDLE","RIGHT","usePostFXs","renderTarget","minFilter","magFilter","format","stencilBuffer","fxaa","ShaderPass","FXAAShader","uniforms","value","renderToScreen","composer","EffectComposer","addPass","RenderPass","BloomPass","avatarUrl","url","textureLoader","iconTexture","load","wrapS","wrapT","anisotropy","avatarMaterial","map","side","alphaTest","iconGeometry","avatarObject","rotation","name","username","font","nameGeometry","size","curveSegments","bevelThickness","bevelSize","bevelEnabled","nameMaterial","color","nameObject","furnitureControl","TransformControls","onmousemove","onmousedown","loadRoom","furniture","furnitures","loadFurniture","then","obj","push","renderWithPostFXs","renderWithoutPostFXs","domElement","renderFrameRequestId","requestAnimationFrame","getDelta","mixer","update","render","clear","roomType","GLTFLoader","gltf","traverse","child","receiveShadow","material","roomObj","applyCarpetColor","def","find","id","Promise","res","rej","model","animations","clip","clipAction","play","metalness","applyCustomColor","texture","applyCustomTexture","colorHex","parseInt","carpetColor","substr","setHex","t","keys","prop","val","props","undefined","document","createElement","emissive","img","Image","onload","uvInfo","uv","getContext","drawImage","flipY","needsUpdate","src","ev","rect","getBoundingClientRect","clientX","left","clientY","top","pos","updateMatrixWorld","raycaster","setFromCamera","intersects","intersectObjects","object","isSelectedObject","intersected","getRoot","button","selectedObj","selectFurniture","found","parent","setMode","attach","detach","uuid","exitTransformMode","remove","filter","f","cancelAnimationFrame","dispose","prototype","extend","data","selected","objectHeight","orbitRadius","$el","cullFace","light","grid","timer","Date","now","sin","cos","lookAt","clone","current","getObjectByName","objectBoundingBox","setFromObject","max","min","objectWidth","objectDepth","horizontal","hypot","aspect","tan","_h","$createElement","_self","_c","attrs","storeItems","room","i18n","components","XPreview","acct","String","required","objectSelected","selectedFurnitureName","selectedFurnitureInfo","selectedFurnitureProps","isTranslateMode","isRotateMode","changed","faBoxOpen","faSave","faTrashAlt","faUndo","faArrowsAlt","faBan","faBroom","addEventListener","beforeunload","$root","api","assign","parse","$store","getters","isSignedIn","state","userId","device","roomGraphicsQuality","findFurnitureById","$t","JSON","stringify","$nextTick","$refs","preview","roomUseOrthographicCamera","to","from","next","dialog","text","showCancelButton","canceled","destroy","removeEventListener","methods","e","preventDefault","returnValue","result","title","select","items","item","addFurniture","removeFurniture","getRoomInfo","catch","message","removeAllFurnitures","$chooseDriveFile","multiple","file","updateProp","thumbnailUrl","getSelectedObject","updateCarpetColor","changeRoomType","exit","enterTransformMode","_vm","staticClass","_v","_s","ref","_l","k","on","$event","chooseImage","domProps","updateColor","_e","translate","rotate","updateRoomType","scopedSlots","_u","fn","proxy","save","content","module","locals","exports","default","place","Table","Board","Chair","color1","color2","Cushion","Leg","Cover","Pad","screen","Screen","CarpetAreaA","CarpetAreaB","Mat","main","Cube","photo","Photo","Frame","body","belly","Body","Belly","picture","Poster","Sofa","Step","Bin","image","Image_Front","Image_Back","___CSS_LOADER_API_IMPORT___"],"mappings":"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","file":"30.11.37.1.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"hveuntkp\"},[(_vm.objectSelected)?_c('div',{staticClass:\"controller\"},[_c('section',[_c('p',{staticClass:\"name\"},[_vm._v(_vm._s(_vm.selectedFurnitureName))]),_c('x-preview',{ref:\"preview\"}),(_vm.selectedFurnitureInfo.props)?_vm._l((Object.keys(_vm.selectedFurnitureInfo.props)),function(k){return _c('div',{key:k},[_c('p',[_vm._v(_vm._s(k))]),(_vm.selectedFurnitureInfo.props[k] === 'image')?[_c('ui-button',{on:{\"click\":function($event){return _vm.chooseImage(k)}}},[_vm._v(_vm._s(_vm.$t('chooseImage')))])]:(_vm.selectedFurnitureInfo.props[k] === 'color')?[_c('input',{attrs:{\"type\":\"color\"},domProps:{\"value\":_vm.selectedFurnitureProps ? _vm.selectedFurnitureProps[k] : null},on:{\"change\":function($event){return _vm.updateColor(k, $event)}}})]:_vm._e()],2)}):_vm._e()],2),_c('section',[_c('ui-button',{attrs:{\"primary\":_vm.isTranslateMode},on:{\"click\":function($event){return _vm.translate()}}},[_c('fa',{attrs:{\"icon\":_vm.faArrowsAlt}}),_vm._v(\" \"+_vm._s(_vm.$t('translate')))],1),_c('ui-button',{attrs:{\"primary\":_vm.isRotateMode},on:{\"click\":function($event){return _vm.rotate()}}},[_c('fa',{attrs:{\"icon\":_vm.faUndo}}),_vm._v(\" \"+_vm._s(_vm.$t('rotate')))],1),(_vm.isTranslateMode || _vm.isRotateMode)?_c('ui-button',{on:{\"click\":function($event){return _vm.exit()}}},[_c('fa',{attrs:{\"icon\":_vm.faBan}}),_vm._v(\" \"+_vm._s(_vm.$t('exit')))],1):_vm._e()],1),_c('section',[_c('ui-button',{on:{\"click\":function($event){return _vm.remove()}}},[_c('fa',{attrs:{\"icon\":_vm.faTrashAlt}}),_vm._v(\" \"+_vm._s(_vm.$t('remove')))],1)],1)]):_vm._e(),(_vm.isMyRoom)?_c('div',{staticClass:\"menu\"},[_c('section',[_c('ui-button',{on:{\"click\":function($event){return _vm.add()}}},[_c('fa',{attrs:{\"icon\":_vm.faBoxOpen}}),_vm._v(\" \"+_vm._s(_vm.$t('add-furniture')))],1)],1),_c('section',[_c('ui-select',{attrs:{\"value\":_vm.roomType},on:{\"input\":function($event){return _vm.updateRoomType($event)}},scopedSlots:_vm._u([{key:\"label\",fn:function(){return [_vm._v(_vm._s(_vm.$t('room-type')))]},proxy:true}],null,false,3739269933)},[_c('option',{attrs:{\"value\":\"default\"}},[_vm._v(_vm._s(_vm.$t('rooms.default')))]),_c('option',{attrs:{\"value\":\"washitsu\"}},[_vm._v(_vm._s(_vm.$t('rooms.washitsu')))])]),(_vm.roomType === 'default')?_c('label',[_c('span',[_vm._v(_vm._s(_vm.$t('carpet-color')))]),_c('input',{attrs:{\"type\":\"color\"},domProps:{\"value\":_vm.carpetColor},on:{\"change\":function($event){return _vm.updateCarpetColor($event)}}})]):_vm._e()],1),_c('section',[_c('ui-button',{attrs:{\"primary\":_vm.changed},on:{\"click\":function($event){return _vm.save()}}},[_c('fa',{attrs:{\"icon\":_vm.faSave}}),_vm._v(\" \"+_vm._s(_vm.$t('save')))],1),_c('ui-button',{on:{\"click\":function($event){return _vm.clear()}}},[_c('fa',{attrs:{\"icon\":_vm.faBroom}}),_vm._v(\" \"+_vm._s(_vm.$t('clear')))],1)],1)]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport autobind from 'autobind-decorator';\nimport { v4 as uuid } from 'uuid';\nimport * as THREE from 'three';\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer.js';\nimport { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass.js';\nimport { ShaderPass } from 'three/examples/jsm/postprocessing/ShaderPass.js';\nimport { BloomPass } from 'three/examples/jsm/postprocessing/BloomPass.js';\nimport { FXAAShader } from 'three/examples/jsm/shaders/FXAAShader.js';\nimport { TransformControls } from 'three/examples/jsm/controls/TransformControls.js';\nimport { query as urlQuery } from '../../../../../prelude/url';\nconst furnitureDefs = require('./furnitures.json5');\nTHREE.ImageUtils.crossOrigin = '';\n/**\n * MisskeyRoom Core Engine\n */\nexport class Room {\n    constructor(user, isMyRoom, roomInfo, container, options) {\n        this.mixers = [];\n        this.objects = [];\n        this.selectedObject = null;\n        this.isTransformMode = false;\n        this.roomInfo = roomInfo;\n        this.graphicsQuality = options.graphicsQuality;\n        this.onChangeSelect = options.onChangeSelect;\n        this.clock = new THREE.Clock(true);\n        //#region Init a scene\n        this.scene = new THREE.Scene();\n        const width = window.innerWidth;\n        const height = window.innerHeight;\n        //#region Init a renderer\n        this.renderer = new THREE.WebGLRenderer({\n            antialias: false,\n            stencil: false,\n            alpha: false,\n            powerPreference: this.graphicsQuality === 'ultra' ? 'high-performance' :\n                this.graphicsQuality === 'high' ? 'high-performance' :\n                    this.graphicsQuality === 'medium' ? 'default' :\n                        this.graphicsQuality === 'low' ? 'low-power' :\n                            'low-power' // cheep\n        });\n        this.renderer.setPixelRatio(window.devicePixelRatio);\n        this.renderer.setSize(width, height);\n        this.renderer.autoClear = false;\n        this.renderer.setClearColor(new THREE.Color(0x051f2d));\n        this.renderer.shadowMap.enabled = this.enableShadow;\n        this.renderer.shadowMap.type =\n            this.graphicsQuality === 'ultra' ? THREE.PCFSoftShadowMap :\n                this.graphicsQuality === 'high' ? THREE.PCFSoftShadowMap :\n                    this.graphicsQuality === 'medium' ? THREE.PCFShadowMap :\n                        this.graphicsQuality === 'low' ? THREE.BasicShadowMap :\n                            THREE.BasicShadowMap; // cheep\n        container.appendChild(this.canvas);\n        //#endregion\n        //#region Init a camera\n        this.camera = options.useOrthographicCamera\n            ? new THREE.OrthographicCamera(width / -2, width / 2, height / 2, height / -2, -10, 10)\n            : new THREE.PerspectiveCamera(45, width / height);\n        if (options.useOrthographicCamera) {\n            this.camera.position.x = 2;\n            this.camera.position.y = 2;\n            this.camera.position.z = 2;\n            this.camera.zoom = 100;\n            this.camera.updateProjectionMatrix();\n        }\n        else {\n            this.camera.position.x = 5;\n            this.camera.position.y = 2;\n            this.camera.position.z = 5;\n        }\n        this.scene.add(this.camera);\n        //#endregion\n        //#region AmbientLight\n        const ambientLight = new THREE.AmbientLight(0xffffff, 1);\n        this.scene.add(ambientLight);\n        //#endregion\n        if (this.graphicsQuality !== 'cheep') {\n            //#region Room light\n            const roomLight = new THREE.SpotLight(0xffffff, 0.1);\n            roomLight.position.set(0, 8, 0);\n            roomLight.castShadow = this.enableShadow;\n            roomLight.shadow.bias = -0.0001;\n            roomLight.shadow.mapSize.width = this.shadowQuality;\n            roomLight.shadow.mapSize.height = this.shadowQuality;\n            roomLight.shadow.camera.near = 0.1;\n            roomLight.shadow.camera.far = 9;\n            roomLight.shadow.camera.fov = 45;\n            this.scene.add(roomLight);\n            //#endregion\n        }\n        //#region Out light\n        const outLight1 = new THREE.SpotLight(0xffffff, 0.4);\n        outLight1.position.set(9, 3, -2);\n        outLight1.castShadow = this.enableShadow;\n        outLight1.shadow.bias = -0.001; // アクネ、アーチファクト対策 その代わりピーターパンが発生する可能性がある\n        outLight1.shadow.mapSize.width = this.shadowQuality;\n        outLight1.shadow.mapSize.height = this.shadowQuality;\n        outLight1.shadow.camera.near = 6;\n        outLight1.shadow.camera.far = 15;\n        outLight1.shadow.camera.fov = 45;\n        this.scene.add(outLight1);\n        const outLight2 = new THREE.SpotLight(0xffffff, 0.2);\n        outLight2.position.set(-2, 3, 9);\n        outLight2.castShadow = false;\n        outLight2.shadow.bias = -0.001; // アクネ、アーチファクト対策 その代わりピーターパンが発生する可能性がある\n        outLight2.shadow.camera.near = 6;\n        outLight2.shadow.camera.far = 15;\n        outLight2.shadow.camera.fov = 45;\n        this.scene.add(outLight2);\n        //#endregion\n        //#region Init a controller\n        this.controls = new OrbitControls(this.camera, this.canvas);\n        this.controls.target.set(0, 1, 0);\n        this.controls.enableZoom = true;\n        this.controls.enablePan = isMyRoom;\n        this.controls.minPolarAngle = 0;\n        this.controls.maxPolarAngle = Math.PI / 2;\n        this.controls.minAzimuthAngle = 0;\n        this.controls.maxAzimuthAngle = Math.PI / 2;\n        this.controls.enableDamping = true;\n        this.controls.dampingFactor = 0.2;\n        this.controls.mouseButtons.LEFT = 1;\n        this.controls.mouseButtons.MIDDLE = 2;\n        this.controls.mouseButtons.RIGHT = 0;\n        //#endregion\n        //#region POST FXs\n        if (!this.usePostFXs) {\n            this.composer = null;\n        }\n        else {\n            const renderTarget = new THREE.WebGLRenderTarget(width, height, {\n                minFilter: THREE.LinearFilter,\n                magFilter: THREE.LinearFilter,\n                format: THREE.RGBFormat,\n                stencilBuffer: false,\n            });\n            const fxaa = new ShaderPass(FXAAShader);\n            fxaa.uniforms['resolution'].value = new THREE.Vector2(1 / width, 1 / height);\n            fxaa.renderToScreen = true;\n            this.composer = new EffectComposer(this.renderer, renderTarget);\n            this.composer.addPass(new RenderPass(this.scene, this.camera));\n            if (this.graphicsQuality === 'ultra') {\n                this.composer.addPass(new BloomPass(0.25, 30, 128.0, 512));\n            }\n            this.composer.addPass(fxaa);\n        }\n        //#endregion\n        //#endregion\n        //#region Label\n        //#region Avatar\n        const avatarUrl = `/proxy/?${urlQuery({ url: user.avatarUrl })}`;\n        const textureLoader = new THREE.TextureLoader();\n        textureLoader.crossOrigin = 'anonymous';\n        const iconTexture = textureLoader.load(avatarUrl);\n        iconTexture.wrapS = THREE.RepeatWrapping;\n        iconTexture.wrapT = THREE.RepeatWrapping;\n        iconTexture.anisotropy = 16;\n        const avatarMaterial = new THREE.MeshBasicMaterial({\n            map: iconTexture,\n            side: THREE.DoubleSide,\n            alphaTest: 0.5\n        });\n        const iconGeometry = new THREE.PlaneGeometry(1, 1);\n        const avatarObject = new THREE.Mesh(iconGeometry, avatarMaterial);\n        avatarObject.position.set(-3, 2.5, 2);\n        avatarObject.rotation.y = Math.PI / 2;\n        avatarObject.castShadow = false;\n        this.scene.add(avatarObject);\n        //#endregion\n        //#region Username\n        const name = user.username;\n        new THREE.FontLoader().load('/assets/fonts/helvetiker_regular.typeface.json', font => {\n            const nameGeometry = new THREE.TextGeometry(name, {\n                size: 0.5,\n                height: 0,\n                curveSegments: 8,\n                font: font,\n                bevelThickness: 0,\n                bevelSize: 0,\n                bevelEnabled: false\n            });\n            const nameMaterial = new THREE.MeshLambertMaterial({\n                color: 0xffffff\n            });\n            const nameObject = new THREE.Mesh(nameGeometry, nameMaterial);\n            nameObject.position.set(-3, 2.25, 1.25);\n            nameObject.rotation.y = Math.PI / 2;\n            nameObject.castShadow = false;\n            this.scene.add(nameObject);\n        });\n        //#endregion\n        //#endregion\n        //#region Interaction\n        if (isMyRoom) {\n            this.furnitureControl = new TransformControls(this.camera, this.canvas);\n            this.scene.add(this.furnitureControl);\n            // Hover highlight\n            this.canvas.onmousemove = this.onmousemove;\n            // Click\n            this.canvas.onmousedown = this.onmousedown;\n        }\n        //#endregion\n        //#region Init room\n        this.loadRoom();\n        //#endregion\n        //#region Load furnitures\n        for (const furniture of this.furnitures) {\n            this.loadFurniture(furniture).then(obj => {\n                this.scene.add(obj.scene);\n                this.objects.push(obj.scene);\n            });\n        }\n        //#endregion\n        // Start render\n        if (this.usePostFXs) {\n            this.renderWithPostFXs();\n        }\n        else {\n            this.renderWithoutPostFXs();\n        }\n    }\n    get canvas() {\n        return this.renderer.domElement;\n    }\n    get furnitures() {\n        return this.roomInfo.furnitures;\n    }\n    set furnitures(furnitures) {\n        this.roomInfo.furnitures = furnitures;\n    }\n    get enableShadow() {\n        return this.graphicsQuality != 'cheep';\n    }\n    get usePostFXs() {\n        return this.graphicsQuality !== 'cheep' && this.graphicsQuality !== 'low';\n    }\n    get shadowQuality() {\n        return (this.graphicsQuality === 'ultra' ? 16384 :\n            this.graphicsQuality === 'high' ? 8192 :\n                this.graphicsQuality === 'medium' ? 4096 :\n                    this.graphicsQuality === 'low' ? 1024 :\n                        0); // cheep\n    }\n    renderWithoutPostFXs() {\n        this.renderFrameRequestId =\n            window.requestAnimationFrame(this.renderWithoutPostFXs);\n        // Update animations\n        const clock = this.clock.getDelta();\n        for (const mixer of this.mixers) {\n            mixer.update(clock);\n        }\n        this.controls.update();\n        this.renderer.render(this.scene, this.camera);\n    }\n    renderWithPostFXs() {\n        this.renderFrameRequestId =\n            window.requestAnimationFrame(this.renderWithPostFXs);\n        // Update animations\n        const clock = this.clock.getDelta();\n        for (const mixer of this.mixers) {\n            mixer.update(clock);\n        }\n        this.controls.update();\n        this.renderer.clear();\n        this.composer.render();\n    }\n    loadRoom() {\n        const type = this.roomInfo.roomType;\n        new GLTFLoader().load(`/assets/room/rooms/${type}/${type}.glb`, gltf => {\n            gltf.scene.traverse(child => {\n                if (!(child instanceof THREE.Mesh))\n                    return;\n                child.receiveShadow = this.enableShadow;\n                child.material = new THREE.MeshLambertMaterial({\n                    color: child.material.color,\n                    map: child.material.map,\n                    name: child.material.name,\n                });\n                // 異方性フィルタリング\n                if (child.material.map && this.graphicsQuality !== 'cheep') {\n                    child.material.map.minFilter = THREE.LinearMipMapLinearFilter;\n                    child.material.map.magFilter = THREE.LinearMipMapLinearFilter;\n                    child.material.map.anisotropy = 8;\n                }\n            });\n            gltf.scene.position.set(0, 0, 0);\n            this.scene.add(gltf.scene);\n            this.roomObj = gltf.scene;\n            if (this.roomInfo.roomType === 'default') {\n                this.applyCarpetColor();\n            }\n        });\n    }\n    loadFurniture(furniture) {\n        const def = furnitureDefs.find(d => d.id === furniture.type);\n        return new Promise((res, rej) => {\n            const loader = new GLTFLoader();\n            loader.load(`/assets/room/furnitures/${furniture.type}/${furniture.type}.glb`, gltf => {\n                const model = gltf.scene;\n                // Load animation\n                if (gltf.animations.length > 0) {\n                    const mixer = new THREE.AnimationMixer(model);\n                    this.mixers.push(mixer);\n                    for (const clip of gltf.animations) {\n                        mixer.clipAction(clip).play();\n                    }\n                }\n                model.name = furniture.id;\n                model.position.x = furniture.position.x;\n                model.position.y = furniture.position.y;\n                model.position.z = furniture.position.z;\n                model.rotation.x = furniture.rotation.x;\n                model.rotation.y = furniture.rotation.y;\n                model.rotation.z = furniture.rotation.z;\n                model.traverse(child => {\n                    if (!(child instanceof THREE.Mesh))\n                        return;\n                    child.castShadow = this.enableShadow;\n                    child.receiveShadow = this.enableShadow;\n                    child.material.metalness = 0;\n                    // 異方性フィルタリング\n                    if (child.material.map && this.graphicsQuality !== 'cheep') {\n                        child.material.map.minFilter = THREE.LinearMipMapLinearFilter;\n                        child.material.map.magFilter = THREE.LinearMipMapLinearFilter;\n                        child.material.map.anisotropy = 8;\n                    }\n                });\n                if (def.color) { // カスタムカラー\n                    this.applyCustomColor(model);\n                }\n                if (def.texture) { // カスタムテクスチャ\n                    this.applyCustomTexture(model);\n                }\n                res(gltf);\n            }, null, rej);\n        });\n    }\n    applyCarpetColor() {\n        this.roomObj.traverse(child => {\n            if (!(child instanceof THREE.Mesh))\n                return;\n            if (child.material &&\n                child.material.name &&\n                child.material.name === 'Carpet') {\n                const colorHex = parseInt(this.roomInfo.carpetColor.substr(1), 16);\n                child.material.color.setHex(colorHex);\n            }\n        });\n    }\n    applyCustomColor(model) {\n        const furniture = this.furnitures.find(furniture => furniture.id === model.name);\n        const def = furnitureDefs.find(d => d.id === furniture.type);\n        if (def.color == null)\n            return;\n        model.traverse(child => {\n            if (!(child instanceof THREE.Mesh))\n                return;\n            for (const t of Object.keys(def.color)) {\n                if (!child.material ||\n                    !child.material.name ||\n                    child.material.name !== t)\n                    continue;\n                const prop = def.color[t];\n                const val = furniture.props ? furniture.props[prop] : undefined;\n                if (val == null)\n                    continue;\n                const colorHex = parseInt(val.substr(1), 16);\n                child.material.color.setHex(colorHex);\n            }\n        });\n    }\n    applyCustomTexture(model) {\n        const furniture = this.furnitures.find(furniture => furniture.id === model.name);\n        const def = furnitureDefs.find(d => d.id === furniture.type);\n        if (def.texture == null)\n            return;\n        model.traverse(child => {\n            if (!(child instanceof THREE.Mesh))\n                return;\n            for (const t of Object.keys(def.texture)) {\n                if (child.name !== t)\n                    continue;\n                const prop = def.texture[t].prop;\n                const val = furniture.props ? furniture.props[prop] : undefined;\n                if (val == null)\n                    continue;\n                const canvas = document.createElement('canvas');\n                canvas.height = 1024;\n                canvas.width = 1024;\n                child.material = new THREE.MeshLambertMaterial({\n                    emissive: 0x111111,\n                    side: THREE.DoubleSide,\n                    alphaTest: 0.5,\n                });\n                const img = new Image();\n                img.crossOrigin = 'anonymous';\n                img.onload = () => {\n                    const uvInfo = def.texture[t].uv;\n                    const ctx = canvas.getContext('2d');\n                    ctx.drawImage(img, 0, 0, img.width, img.height, uvInfo.x, uvInfo.y, uvInfo.width, uvInfo.height);\n                    const texture = new THREE.Texture(canvas);\n                    texture.wrapS = THREE.RepeatWrapping;\n                    texture.wrapT = THREE.RepeatWrapping;\n                    texture.anisotropy = 16;\n                    texture.flipY = false;\n                    child.material.map = texture;\n                    child.material.needsUpdate = true;\n                    child.material.map.needsUpdate = true;\n                };\n                img.src = val;\n            }\n        });\n    }\n    onmousemove(ev) {\n        if (this.isTransformMode)\n            return;\n        const rect = ev.target.getBoundingClientRect();\n        const x = (((ev.clientX * window.devicePixelRatio) - rect.left) / this.canvas.width) * 2 - 1;\n        const y = -(((ev.clientY * window.devicePixelRatio) - rect.top) / this.canvas.height) * 2 + 1;\n        const pos = new THREE.Vector2(x, y);\n        this.camera.updateMatrixWorld();\n        const raycaster = new THREE.Raycaster();\n        raycaster.setFromCamera(pos, this.camera);\n        const intersects = raycaster.intersectObjects(this.objects, true);\n        for (const object of this.objects) {\n            if (this.isSelectedObject(object))\n                continue;\n            object.traverse(child => {\n                if (child instanceof THREE.Mesh) {\n                    child.material.emissive.setHex(0x000000);\n                }\n            });\n        }\n        if (intersects.length > 0) {\n            const intersected = this.getRoot(intersects[0].object);\n            if (this.isSelectedObject(intersected))\n                return;\n            intersected.traverse(child => {\n                if (child instanceof THREE.Mesh) {\n                    child.material.emissive.setHex(0x191919);\n                }\n            });\n        }\n    }\n    onmousedown(ev) {\n        if (this.isTransformMode)\n            return;\n        if (ev.target !== this.canvas || ev.button !== 0)\n            return;\n        const rect = ev.target.getBoundingClientRect();\n        const x = (((ev.clientX * window.devicePixelRatio) - rect.left) / this.canvas.width) * 2 - 1;\n        const y = -(((ev.clientY * window.devicePixelRatio) - rect.top) / this.canvas.height) * 2 + 1;\n        const pos = new THREE.Vector2(x, y);\n        this.camera.updateMatrixWorld();\n        const raycaster = new THREE.Raycaster();\n        raycaster.setFromCamera(pos, this.camera);\n        const intersects = raycaster.intersectObjects(this.objects, true);\n        for (const object of this.objects) {\n            object.traverse(child => {\n                if (child instanceof THREE.Mesh) {\n                    child.material.emissive.setHex(0x000000);\n                }\n            });\n        }\n        if (intersects.length > 0) {\n            const selectedObj = this.getRoot(intersects[0].object);\n            this.selectFurniture(selectedObj);\n        }\n        else {\n            this.selectedObject = null;\n            this.onChangeSelect(null);\n        }\n    }\n    getRoot(obj) {\n        let found = false;\n        let x = obj.parent;\n        while (!found) {\n            if (x.parent.parent == null) {\n                found = true;\n            }\n            else {\n                x = x.parent;\n            }\n        }\n        return x;\n    }\n    isSelectedObject(obj) {\n        if (this.selectedObject == null) {\n            return false;\n        }\n        else {\n            return obj.name === this.selectedObject.name;\n        }\n    }\n    selectFurniture(obj) {\n        this.selectedObject = obj;\n        this.onChangeSelect(obj);\n        obj.traverse(child => {\n            if (child instanceof THREE.Mesh) {\n                child.material.emissive.setHex(0xff0000);\n            }\n        });\n    }\n    /**\n     * 家具の移動/回転モードにします\n     * @param type 移動か回転か\n     */\n    enterTransformMode(type) {\n        this.isTransformMode = true;\n        this.furnitureControl.setMode(type);\n        this.furnitureControl.attach(this.selectedObject);\n    }\n    /**\n     * 家具の移動/回転モードを終了します\n     */\n    exitTransformMode() {\n        this.isTransformMode = false;\n        this.furnitureControl.detach();\n    }\n    /**\n     * 家具プロパティを更新します\n     * @param key プロパティ名\n     * @param value 値\n     */\n    updateProp(key, value) {\n        const furniture = this.furnitures.find(furniture => furniture.id === this.selectedObject.name);\n        if (furniture.props == null)\n            furniture.props = {};\n        furniture.props[key] = value;\n        this.applyCustomColor(this.selectedObject);\n        this.applyCustomTexture(this.selectedObject);\n    }\n    /**\n     * 部屋に家具を追加します\n     * @param type 家具の種類\n     */\n    addFurniture(type) {\n        const furniture = {\n            id: uuid(),\n            type: type,\n            position: {\n                x: 0,\n                y: 0,\n                z: 0,\n            },\n            rotation: {\n                x: 0,\n                y: 0,\n                z: 0,\n            },\n        };\n        this.furnitures.push(furniture);\n        this.loadFurniture(furniture).then(obj => {\n            this.scene.add(obj.scene);\n            this.objects.push(obj.scene);\n        });\n    }\n    /**\n     * 現在選択されている家具を部屋から削除します\n     */\n    removeFurniture() {\n        this.exitTransformMode();\n        const obj = this.selectedObject;\n        this.scene.remove(obj);\n        this.objects = this.objects.filter(object => object.name !== obj.name);\n        this.furnitures = this.furnitures.filter(furniture => furniture.id !== obj.name);\n        this.selectedObject = null;\n        this.onChangeSelect(null);\n    }\n    /**\n     * 全ての家具を部屋から削除します\n     */\n    removeAllFurnitures() {\n        this.exitTransformMode();\n        for (const obj of this.objects) {\n            this.scene.remove(obj);\n        }\n        this.objects = [];\n        this.furnitures = [];\n        this.selectedObject = null;\n        this.onChangeSelect(null);\n    }\n    /**\n     * 部屋の床の色を変更します\n     * @param color 色\n     */\n    updateCarpetColor(color) {\n        this.roomInfo.carpetColor = color;\n        this.applyCarpetColor();\n    }\n    /**\n     * 部屋の種類を変更します\n     * @param type 種類\n     */\n    changeRoomType(type) {\n        this.roomInfo.roomType = type;\n        this.scene.remove(this.roomObj);\n        this.loadRoom();\n    }\n    /**\n     * 部屋データを取得します\n     */\n    getRoomInfo() {\n        for (const obj of this.objects) {\n            const furniture = this.furnitures.find(f => f.id === obj.name);\n            furniture.position.x = obj.position.x;\n            furniture.position.y = obj.position.y;\n            furniture.position.z = obj.position.z;\n            furniture.rotation.x = obj.rotation.x;\n            furniture.rotation.y = obj.rotation.y;\n            furniture.rotation.z = obj.rotation.z;\n        }\n        return this.roomInfo;\n    }\n    /**\n     * 選択されている家具を取得します\n     */\n    getSelectedObject() {\n        return this.selectedObject;\n    }\n    findFurnitureById(id) {\n        return this.furnitures.find(furniture => furniture.id === id);\n    }\n    /**\n     * レンダリングを終了します\n     */\n    destroy() {\n        // Stop render loop\n        window.cancelAnimationFrame(this.renderFrameRequestId);\n        this.controls.dispose();\n        this.scene.dispose();\n    }\n}\n__decorate([\n    autobind\n], Room.prototype, \"renderWithoutPostFXs\", null);\n__decorate([\n    autobind\n], Room.prototype, \"renderWithPostFXs\", null);\n__decorate([\n    autobind\n], Room.prototype, \"loadRoom\", null);\n__decorate([\n    autobind\n], Room.prototype, \"loadFurniture\", null);\n__decorate([\n    autobind\n], Room.prototype, \"applyCarpetColor\", null);\n__decorate([\n    autobind\n], Room.prototype, \"applyCustomColor\", null);\n__decorate([\n    autobind\n], Room.prototype, \"applyCustomTexture\", null);\n__decorate([\n    autobind\n], Room.prototype, \"onmousemove\", null);\n__decorate([\n    autobind\n], Room.prototype, \"onmousedown\", null);\n__decorate([\n    autobind\n], Room.prototype, \"getRoot\", null);\n__decorate([\n    autobind\n], Room.prototype, \"isSelectedObject\", null);\n__decorate([\n    autobind\n], Room.prototype, \"selectFurniture\", null);\n__decorate([\n    autobind\n], Room.prototype, \"enterTransformMode\", null);\n__decorate([\n    autobind\n], Room.prototype, \"exitTransformMode\", null);\n__decorate([\n    autobind\n], Room.prototype, \"updateProp\", null);\n__decorate([\n    autobind\n], Room.prototype, \"addFurniture\", null);\n__decorate([\n    autobind\n], Room.prototype, \"removeFurniture\", null);\n__decorate([\n    autobind\n], Room.prototype, \"removeAllFurnitures\", null);\n__decorate([\n    autobind\n], Room.prototype, \"updateCarpetColor\", null);\n__decorate([\n    autobind\n], Room.prototype, \"changeRoomType\", null);\n__decorate([\n    autobind\n], Room.prototype, \"getRoomInfo\", null);\n__decorate([\n    autobind\n], Room.prototype, \"getSelectedObject\", null);\n__decorate([\n    autobind\n], Room.prototype, \"findFurnitureById\", null);\n__decorate([\n    autobind\n], Room.prototype, \"destroy\", null);\n","import mod from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--5-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./preview.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--5-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./preview.vue?vue&type=script&lang=ts&\"","import Vue from 'vue';\nimport * as THREE from 'three';\nexport default Vue.extend({\n    data() {\n        return {\n            selected: null,\n            objectHeight: 0,\n            orbitRadius: 5\n        };\n    },\n    mounted() {\n        const canvas = this.$el;\n        const width = canvas.width;\n        const height = canvas.height;\n        const scene = new THREE.Scene();\n        const renderer = new THREE.WebGLRenderer({\n            canvas: canvas,\n            antialias: true,\n            alpha: false\n        });\n        renderer.setPixelRatio(window.devicePixelRatio);\n        renderer.setSize(width, height);\n        renderer.setClearColor(0x000000);\n        renderer.autoClear = false;\n        renderer.shadowMap.enabled = true;\n        renderer.shadowMap.cullFace = THREE.CullFaceBack;\n        const camera = new THREE.PerspectiveCamera(75, width / height, 0.1, 100);\n        camera.zoom = 10;\n        camera.position.x = 0;\n        camera.position.y = 2;\n        camera.position.z = 0;\n        camera.updateProjectionMatrix();\n        scene.add(camera);\n        const ambientLight = new THREE.AmbientLight(0xffffff, 1);\n        ambientLight.castShadow = false;\n        scene.add(ambientLight);\n        const light = new THREE.PointLight(0xffffff, 1, 100);\n        light.position.set(3, 3, 3);\n        scene.add(light);\n        const grid = new THREE.GridHelper(5, 16, 0x444444, 0x222222);\n        scene.add(grid);\n        const render = () => {\n            const timer = Date.now() * 0.0004;\n            requestAnimationFrame(render);\n            camera.position.y = Math.sin(Math.PI / 6) * this.orbitRadius; // Math.PI / 6 => 30deg\n            camera.position.z = Math.cos(timer) * this.orbitRadius;\n            camera.position.x = Math.sin(timer) * this.orbitRadius;\n            camera.lookAt(new THREE.Vector3(0, this.objectHeight / 2, 0));\n            renderer.render(scene, camera);\n        };\n        this.selected = selected => {\n            const obj = selected.clone();\n            // Remove current object\n            const current = scene.getObjectByName('obj');\n            if (current != null) {\n                scene.remove(current);\n            }\n            // Add new object\n            obj.name = 'obj';\n            obj.position.x = 0;\n            obj.position.y = 0;\n            obj.position.z = 0;\n            obj.rotation.x = 0;\n            obj.rotation.y = 0;\n            obj.rotation.z = 0;\n            obj.traverse(child => {\n                if (child instanceof THREE.Mesh) {\n                    child.material = child.material.clone();\n                    return child.material.emissive.setHex(0x000000);\n                }\n            });\n            const objectBoundingBox = new THREE.Box3().setFromObject(obj);\n            this.objectHeight = objectBoundingBox.max.y - objectBoundingBox.min.y;\n            const objectWidth = objectBoundingBox.max.x - objectBoundingBox.min.x;\n            const objectDepth = objectBoundingBox.max.z - objectBoundingBox.min.z;\n            const horizontal = Math.hypot(objectWidth, objectDepth) / camera.aspect;\n            this.orbitRadius = Math.max(horizontal, this.objectHeight) * camera.zoom * 0.625 / Math.tan(camera.fov * 0.5 * (Math.PI / 180));\n            scene.add(obj);\n        };\n        render();\n    },\n});\n","import { render, staticRenderFns } from \"./preview.vue?vue&type=template&id=a9872372&\"\nimport script from \"./preview.vue?vue&type=script&lang=ts&\"\nexport * from \"./preview.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('canvas',{attrs:{\"width\":\"224\",\"height\":\"128\"}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import Vue from 'vue';\nimport i18n from '../../../../i18n';\nimport { Room } from '../../../scripts/room/room';\nimport parseAcct from '../../../../../../misc/acct/parse';\nimport XPreview from './preview.vue';\nconst storeItems = require('../../../scripts/room/furnitures.json5');\nimport { faBoxOpen, faUndo, faArrowsAlt, faBan, faBroom } from '@fortawesome/free-solid-svg-icons';\nimport { faSave, faTrashAlt } from '@fortawesome/free-regular-svg-icons';\nimport { query as urlQuery } from '../../../../../../prelude/url';\nlet room;\nexport default Vue.extend({\n    i18n: i18n('room'),\n    components: {\n        XPreview\n    },\n    props: {\n        acct: {\n            type: String,\n            required: true\n        },\n    },\n    data() {\n        return {\n            objectSelected: false,\n            selectedFurnitureName: null,\n            selectedFurnitureInfo: null,\n            selectedFurnitureProps: null,\n            roomType: null,\n            carpetColor: null,\n            isTranslateMode: false,\n            isRotateMode: false,\n            isMyRoom: false,\n            changed: false,\n            faBoxOpen, faSave, faTrashAlt, faUndo, faArrowsAlt, faBan, faBroom,\n        };\n    },\n    async mounted() {\n        window.addEventListener('beforeunload', this.beforeunload);\n        const user = await this.$root.api('users/show', Object.assign({}, parseAcct(this.acct)));\n        this.isMyRoom = this.$store.getters.isSignedIn && this.$store.state.i.id === user.id;\n        const roomInfo = await this.$root.api('room/show', {\n            userId: user.id\n        });\n        this.roomType = roomInfo.roomType;\n        this.carpetColor = roomInfo.carpetColor;\n        room = new Room(user, this.isMyRoom, roomInfo, this.$el, {\n            graphicsQuality: this.$store.state.device.roomGraphicsQuality,\n            onChangeSelect: obj => {\n                this.objectSelected = obj != null;\n                if (obj) {\n                    const f = room.findFurnitureById(obj.name);\n                    this.selectedFurnitureName = this.$t('furnitures.' + f.type);\n                    this.selectedFurnitureInfo = storeItems.find(x => x.id === f.type);\n                    this.selectedFurnitureProps = f.props\n                        ? JSON.parse(JSON.stringify(f.props)) // Disable reactivity\n                        : null;\n                    this.$nextTick(() => {\n                        this.$refs.preview.selected(obj);\n                    });\n                }\n            },\n            useOrthographicCamera: this.$store.state.device.roomUseOrthographicCamera\n        });\n    },\n    beforeRouteLeave(to, from, next) {\n        if (this.changed) {\n            this.$root.dialog({\n                type: 'warning',\n                text: this.$t('leave-confirm'),\n                showCancelButton: true\n            }).then(({ canceled }) => {\n                if (canceled) {\n                    next(false);\n                }\n                else {\n                    next();\n                }\n            });\n        }\n        else {\n            next();\n        }\n    },\n    beforeDestroy() {\n        room.destroy();\n        window.removeEventListener('beforeunload', this.beforeunload);\n    },\n    methods: {\n        beforeunload(e) {\n            if (this.changed) {\n                e.preventDefault();\n                e.returnValue = '';\n            }\n        },\n        async add() {\n            const { canceled, result: id } = await this.$root.dialog({\n                type: null,\n                title: this.$t('add-furniture'),\n                select: {\n                    items: storeItems.map(item => ({\n                        value: item.id, text: this.$t('furnitures.' + item.id)\n                    }))\n                },\n                showCancelButton: true\n            });\n            if (canceled)\n                return;\n            room.addFurniture(id);\n            this.changed = true;\n        },\n        remove() {\n            this.isTranslateMode = false;\n            this.isRotateMode = false;\n            room.removeFurniture();\n            this.changed = true;\n        },\n        save() {\n            this.$root.api('room/update', {\n                room: room.getRoomInfo()\n            }).then(() => {\n                this.changed = false;\n                this.$root.dialog({\n                    type: 'success',\n                    text: this.$t('saved')\n                });\n            }).catch((e) => {\n                this.$root.dialog({\n                    type: 'error',\n                    text: e.message\n                });\n            });\n        },\n        clear() {\n            this.$root.dialog({\n                type: 'warning',\n                text: this.$t('clear-confirm'),\n                showCancelButton: true\n            }).then(({ canceled }) => {\n                if (canceled)\n                    return;\n                room.removeAllFurnitures();\n                this.changed = true;\n            });\n        },\n        chooseImage(key) {\n            this.$chooseDriveFile({\n                multiple: false\n            }).then(file => {\n                room.updateProp(key, `/proxy/?${urlQuery({ url: file.thumbnailUrl })}`);\n                this.$refs.preview.selected(room.getSelectedObject());\n                this.changed = true;\n            });\n        },\n        updateColor(key, ev) {\n            room.updateProp(key, ev.target.value);\n            this.$refs.preview.selected(room.getSelectedObject());\n            this.changed = true;\n        },\n        updateCarpetColor(ev) {\n            room.updateCarpetColor(ev.target.value);\n            this.carpetColor = ev.target.value;\n            this.changed = true;\n        },\n        updateRoomType(type) {\n            room.changeRoomType(type);\n            this.roomType = type;\n            this.changed = true;\n        },\n        translate() {\n            if (this.isTranslateMode) {\n                this.exit();\n            }\n            else {\n                this.isRotateMode = false;\n                this.isTranslateMode = true;\n                room.enterTransformMode('translate');\n            }\n            this.changed = true;\n        },\n        rotate() {\n            if (this.isRotateMode) {\n                this.exit();\n            }\n            else {\n                this.isTranslateMode = false;\n                this.isRotateMode = true;\n                room.enterTransformMode('rotate');\n            }\n            this.changed = true;\n        },\n        exit() {\n            this.isTranslateMode = false;\n            this.isRotateMode = false;\n            room.exitTransformMode();\n            this.changed = true;\n        }\n    }\n});\n","import mod from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--5-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./room.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--5-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./room.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./room.vue?vue&type=template&id=1957ba12&scoped=true&\"\nimport script from \"./room.vue?vue&type=script&lang=ts&\"\nexport * from \"./room.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./room.vue?vue&type=style&index=0&id=1957ba12&lang=stylus&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1957ba12\",\n  null\n  \n)\n\nexport default component.exports","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/postcss-loader/src/index.js??ref--1-oneOf-1-2!../../../../../../../node_modules/stylus-loader/index.js!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./room.vue?vue&type=style&index=0&id=1957ba12&lang=stylus&scoped=true&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"06a6abf5\", content, true, {});","module.exports = [{id:'milk',place:'floor'},{id:'bed',place:'floor'},{id:'low-table',place:'floor',props:{color:'color'},color:{Table:'color'}},{id:'desk',place:'floor',props:{color:'color'},color:{Board:'color'}},{id:'chair',place:'floor',props:{color:'color'},color:{Chair:'color'}},{id:'chair2',place:'floor',props:{color1:'color',color2:'color'},color:{Cushion:'color1',Leg:'color2'}},{id:'fan',place:'wall'},{id:'pc',place:'floor'},{id:'plant',place:'floor'},{id:'plant2',place:'floor'},{id:'eraser',place:'floor'},{id:'pencil',place:'floor'},{id:'pudding',place:'floor'},{id:'cardboard-box',place:'floor'},{id:'cardboard-box2',place:'floor'},{id:'cardboard-box3',place:'floor'},{id:'book',place:'floor',props:{color:'color'},color:{Cover:'color'}},{id:'book2',place:'floor'},{id:'piano',place:'floor'},{id:'facial-tissue',place:'floor'},{id:'server',place:'floor'},{id:'moon',place:'floor'},{id:'corkboard',place:'wall'},{id:'mousepad',place:'floor',props:{color:'color'},color:{Pad:'color'}},{id:'monitor',place:'floor',props:{screen:'image'},texture:{Screen:{prop:'screen',uv:{x:0,y:434,width:1024,height:588}}}},{id:'tv',place:'floor',props:{screen:'image'},texture:{Screen:{prop:'screen',uv:{x:0,y:434,width:1024,height:588}}}},{id:'keyboard',place:'floor'},{id:'carpet-stripe',place:'floor',props:{color1:'color',color2:'color'},color:{CarpetAreaA:'color1',CarpetAreaB:'color2'}},{id:'mat',place:'floor',props:{color:'color'},color:{Mat:'color'}},{id:'color-box',place:'floor',props:{color:'color'},color:{main:'color'}},{id:'wall-clock',place:'wall'},{id:'cube',place:'floor',props:{color:'color'},color:{Cube:'color'}},{id:'photoframe',place:'wall',props:{photo:'image',color:'color'},texture:{Photo:{prop:'photo',uv:{x:0,y:342,width:1024,height:683}}},color:{Frame:'color'}},{id:'pinguin',place:'floor',props:{body:'color',belly:'color'},color:{Body:'body',Belly:'belly'}},{id:'rubik-cube',place:'floor'},{id:'poster-h',place:'wall',props:{picture:'image'},texture:{Poster:{prop:'picture',uv:{x:0,y:277,width:1024,height:745}}}},{id:'poster-v',place:'wall',props:{picture:'image'},texture:{Poster:{prop:'picture',uv:{x:0,y:0,width:745,height:1024}}}},{id:'sofa',place:'floor',props:{color:'color'},color:{Sofa:'color'}},{id:'spiral',place:'floor',props:{color:'color'},color:{Step:'color'}},{id:'bin',place:'floor',props:{color:'color'},color:{Bin:'color'}},{id:'cup-noodle',place:'floor'},{id:'holo-display',place:'floor',props:{image:'image'},texture:{Image_Front:{prop:'image',uv:{x:0,y:0,width:1024,height:1024}},Image_Back:{prop:'image',uv:{x:0,y:0,width:1024,height:1024}}}},{id:'energy-drink',place:'floor'}]","import mod from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/postcss-loader/src/index.js??ref--1-oneOf-1-2!../../../../../../../node_modules/stylus-loader/index.js!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./room.vue?vue&type=style&index=0&id=1957ba12&lang=stylus&scoped=true&\"; export default mod; export * from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/postcss-loader/src/index.js??ref--1-oneOf-1-2!../../../../../../../node_modules/stylus-loader/index.js!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./room.vue?vue&type=style&index=0&id=1957ba12&lang=stylus&scoped=true&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".hveuntkp>.controller[data-v-1957ba12],.hveuntkp>.menu[data-v-1957ba12]{position:fixed;z-index:1;padding:16px;background:var(--face);color:var(--text)}.hveuntkp>.controller>section[data-v-1957ba12],.hveuntkp>.menu>section[data-v-1957ba12]{padding:16px 0}.hveuntkp>.controller>section[data-v-1957ba12]:first-child,.hveuntkp>.menu>section[data-v-1957ba12]:first-child{padding-top:0}.hveuntkp>.controller>section[data-v-1957ba12]:last-child,.hveuntkp>.menu>section[data-v-1957ba12]:last-child{padding-bottom:0}.hveuntkp>.controller>section[data-v-1957ba12]:not(:last-child),.hveuntkp>.menu>section[data-v-1957ba12]:not(:last-child){border-bottom:1px solid var(--faceDivider)}.hveuntkp>.controller[data-v-1957ba12]{top:16px;left:16px;width:256px}.hveuntkp>.controller>section>.name[data-v-1957ba12]{margin:0}.hveuntkp>.menu[data-v-1957ba12]{top:16px;right:16px;width:256px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n"],"sourceRoot":""}